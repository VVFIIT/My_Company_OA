<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thinkgem.jeesite.modules.finance.dao.ReimburseMainDao">
    
	<sql id="faReimburseMainColumns">
		a.id AS "id",
		a.procInstId AS "procInstId",
		a.officeId AS "officeId",
		a.applicantId AS "applicantId",
		a.status AS "status",
		a.applyDate AS "applyDate",
		a.beginDate AS "beginDate",
		a.endDate AS "endDate",
		a.remark AS "remark",
		a.totalAmount AS "totalAmount",
		a.updateDate AS "updateDate",
		a.managerFlag AS "managerFlag",
		a.FAFlag AS "FAFlag",
		a.managerComment AS "managerComment",
		a.FAComment AS "FAComment"
	</sql>
	
	<sql id="faReimburseMainJoins">
	</sql>
    
 	<select id="get" resultType="ReimburseMain">
		SELECT 
			<include refid="faReimburseMainColumns"/>
		FROM fa_reimburse_main a
		<include refid="faReimburseMainJoins"/>
		WHERE a.id = #{id}
	</select>
	
	<select id="findShowList" resultType="ReimburseModel">
		SELECT
			u.name as userName,o.name as officeName,<include refid="faReimburseMainColumns"/>
			FROM fa_reimburse_main a
		JOIN sys_user u ON a.applicantId = u.id
		JOIN sys_office o ON a.officeId = o.id
		<where>
		<if test="status != null and status != ''">
			AND a.status = #{status}
		</if>	
		<if test="procInsId != null and procInsId != ''">
			AND a.procInsId = #{procInsId}
		</if>	
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<select id="findAllList" resultType="ReimburseMain">
		SELECT 
			<include refid="faReimburseMainColumns"/>
		FROM fa_reimburse_main a
		<include refid="faReimburseMainJoins"/>
		<where>
			
		</where>		
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select> 
	
   <select id="getShow" resultType="ReimburseModel">
		SELECT
			u.name as userName,o.name as officeName,
			<include refid="faReimburseMainColumns"/>
			FROM fa_reimburse_main a
		JOIN sys_user u ON a.applicantId = u.id
		JOIN sys_office o ON a.officeId = o.id
		JOIN fa_reimburse_longdistance l on l.mainId=a.id
		JOIN fa_reimburse_hospitality h on h.mainId=a.id
		JOIN fa_reimburse_other oth on oth.mainId=a.id
		JOIN fa_reimburse_taxi ta on ta.mainId=a.id
		<where>
		<if test="id != null and id != ''">
			AND a.id = #{id}
		</if>	
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
	
	<insert id="insert">
		INSERT INTO fa_reimburse_main(
			id,
			procInstId,
			officeId,
			applicantId,
			status,
			applyDate,
			beginDate,
			endDate,
			remark,
			totalAmount,
			updateDate,
			managerFlag,
			FAFlag,
			managerComment,
			FAComment
		) VALUES (
			#{id},
			#{procInstId},
			#{officeId},
			#{applicantId},
			#{status},
			#{applyDate},
			#{beginDate},
			#{endDate},
			#{remark},
			#{totalAmount},
			#{updateDate},
			#{managerFlag},
			#{FAFlag},
			#{managerComment},
			#{FAComment}
		)
	</insert>
	
	<update id="update">
		UPDATE fa_reimburse_main SET 	
			procInstId = #{procInstId},
			officeId = #{officeId},
			applicantId = #{applicantId},
			status = #{status},
			applyDate = #{applyDate},
			beginDate = #{beginDate},
			endDate = #{endDate},
			remark = #{remark},
			totalAmount = #{totalAmount},
			updateDate = #{updateDate},
			managerFlag = #{managerFlag},
			FAFlag = #{FAFlag},
			managerComment = #{managerComment},
			FAComment = #{FAComment}
		WHERE id = #{id}
	</update>
	
	<update id="delete">
		DELETE FROM fa_reimburse_main
		WHERE id = #{id}
	</update>
	
</mapper>